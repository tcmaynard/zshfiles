var AutoSuggest;(function(n){var t;(function(n){var f=function(){function n(){}return n.User="SRCHHPGUSR",n.History="_UR",n}(),u,r,t,i;n.CookieNames=f,u=function(){function n(){}return n.AutoSuggest="AS",n.History="OMW",n}(),n.CrumbNames=u,r=function(){function n(){}return n.CursorPosition="cp",n.Options="o",n.ConversationId="cvid",n.SuggestionCount="sc",n.PartialQuery="pq",n.SuggestionPosition="sp",n.SuggestionType="qs",n.PreviewPaneSuggestionType="qsc",n.SkipValue="sk",n.PreviewPaneSkipValue="skc",n.Ghosting="ghc",n.PreviewPaneDisabled="ppd",n.Css="css",n.CssVersion="ver",n.Count="count",n.DataSet="ds",n.SessionId="sid",n.TimeStamp="qt",n.Query="q",n.ImpressionGuid="ig",n.QFQuery="qry",n}(),n.QueryParams=r,t=function(){function n(){}return n.HistoryEnabled="hs",n.HitHighlighting="h",n.PopularNow="p",n.Local="l",n.Answers="a",n}(),n.Options=t,i=function(){function n(){}return n.Id="id",n.Query="query",n.Url="url",n.Navigation="nav",n.Type="stype",n.Autocomplete="hc",n}(),n.SuggestionAttributes=i})(t=n.Service||(n.Service={}))})(AutoSuggest||(AutoSuggest={})),_w.Bing=_w.Bing||{},Bing.AS=Bing.AS||{},Bing.AS.EventIds={TextChanged:1,SelectPrevItem:2,SelectNextItem:3,UpdateText:4,NavigateSerp:7,ReadyToProcessEvents:8,SelectLeftItem:9,SelectRightItem:10,NavigateLink:11,EnterKeyPressed:12,EscKeyPressed:13,CloseFlyout:15,MouseEnterSuggestion:16,MouseLeaveSuggestion:17,LastSharedEventId:99,ConfigurationSet:100,Initialized:101,RequestSent:102,ApiCallback:103,ApiServiceReceived:104,ValidResponseReceived:105,SuggestionsRendered:106,NoResults:107,InvalidQuery:108,BeforeNavigate:109,UpdateTextAndRequery:110,QueryChanged:111,InstSubmit:112,GhostedSuggestion:113,GhostingSubmit:114,DropDownShown:115,DropDownHidden:116,Disposed:117,PreviewPaneEnabled:118,PreviewPaneDisabled:119,UpdateGhostedText:120},Bing.AS.Constants={KeyCodeBackspace:8,KeyCodeTab:9,KeyCodeEnter:13,KeyCodeEscape:27,KeyCodeSpace:32,KeyCodePageUp:33,KeyCodePageDown:34,KeyCodeEnd:35,KeyCodeArrowLeft:37,KeyCodeArrowUp:38,KeyCodeArrowRight:39,KeyCodeArrowDown:40,KeyCodeInsert:45,KeyCodeDelete:46,KeyCodeImeOpen:229,HitHighlightStartToken:"<strong>",HitHighlightEndToken:"<\/strong>",SuggestionsDataProvider:1,PreviewPaneDataProvider:2},Bing.AS.AutoSuggest=function(){function a(t,i,r,u){if(!v){if(n.config.latencyLag>0&&!u){setTimeout(sj_wf(a,t,i,r,!0),n.config.latencyLag);return}if(n.raiseEvent(Bing.AS.EventIds.ApiCallback),r==n.currentQuery)if(t!=null){if(t.indexOf("NoResults")==0){n.canvas.currentSuggestionList=[],n.raiseEvent(Bing.AS.EventIds.NoResults);return}n.raiseEvent(Bing.AS.EventIds.ValidResponseReceived,r,{},i),c=r,n.canvas.render(t,n.currentQuery,i),h=!0}else n.canvas.currentSuggestionList=[],n.raiseEvent(Bing.AS.EventIds.NoResults)}}function l(n){return r.asf&&!n?it:nt}function w(i,u,f){f=f||n.canvas.selectedSuggestion;switch(i){case t.SuggestionCount:return n.canvas.currentSuggestionList.length+"-"+c.length;case t.PartialQuery:return u?encodeURIComponent(n.currentQuery):n.currentQuery;case t.SuggestionPosition:return f?f.ord+1:-1;case t.SuggestionType:return f?f.src:"n";case t.SkipValue:return f&&f.sk?f.sk:"";case t.PreviewPaneSkipValue:var e=null;return f&&f.qsc&&(e=f.skc?f.skc:""),e;case t.PreviewPaneSuggestionType:return f&&f.qsc?f.qsc:null;case t.Ghosting:return n.ghostInstValue>0?n.ghostInstValue:null;case t.ConversationId:return r.asf?_G.IG:null}}function rt(t,i){var s=[],l=t["0"].Type.toString(),a=k[l],o,e,h,u,r;for(f.appendHistory(i,t,a),e=0;e<t.length;e++){if(o=t[e],h=o.Type,u=o.Suggests,!tt[h]){for(r=0;r<u.length;r++)u[r].ServiceType=h,n.lastSuggestionType=u[r].Type;s=s.concat(u)}n.raiseEvent(Bing.AS.EventIds.ApiServiceReceived,o)}c=i,n.canvas.render(s,n.currentQuery)}function p(){v=!0,sj_evt.unbind(d,p),sj_evt.unbind(g,y),n.raiseEvent(Bing.AS.EventIds.Disposed),Bing.AS.AutoSuggest.prototype.EventRegistry=[]}function y(t){var i=u;u=t[1].layoutType==="1C",i!=u&&n.raiseEvent(u?Bing.AS.EventIds.PreviewPaneDisabled:Bing.AS.EventIds.PreviewPaneEnabled)}var n=this,s;n.config=null,n.currentQuery="",n.apiOptions="",n.canvas=null,n.logMeta="",n.popularNowEnabled=!1,n.cssVersioningEnabled=!1,n.cssVersioningMgr,n.lastSuggestionType,n.data={};var t=AutoSuggest.Service.QueryParams,o=AutoSuggest.Service.Options,nt=[t.PartialQuery,t.SuggestionCount,t.SuggestionPosition,t.SuggestionType,t.SkipValue,t.PreviewPaneSkipValue,t.PreviewPaneSuggestionType,t.Ghosting,t.ConversationId,],it=[t.Ghosting],r,b=0,k={},tt={QR:1,NW:0},c="",f,e=Bing.AS.EtwEventLogger,i,h=!1,u=!1,g="layoutChanged",d="ajax.unload",v=!1;for(sj_evt.bind(g,y,!0),sj_evt.bind(d,p,!1),n.init=function(t,u){var h,s,v,c,l,e;if(n.config=r=t,t.p0)for(h=t.p0.split(","),s=0;s<h.length;s++)v=s.toString(),c=h[v].toString(),k[c]=1;i=new Bing.AS.DataProvider(t,Bing.AS.Constants.SuggestionsDataProvider,a),n.popularNowEnabled=t.ePN,t.eLO&&n.addApiOption(o.Local),t.eAN&&(l=t.as||o.Answers,n.addApiOption(l)),f=new Bing.AS.History(t),f.init(),n.canvas=new Bing.AS.Canvas(n,t,u),(n.cssVersioningEnabled=t.asf&&t.ic&&t.cv)&&(n.cssVersioningMgr=new Bing.AS.CssVersioningManager(n)),e=new Bing.AS.EventRegistration,e.add(Bing.AS.EventIds.SuggestionsRendered,function(i,r,u,e,o){n.raiseEvent(Bing.AS.EventIds.SuggestionsRendered,i,r,u,e,o),t.asf&&f.setQueryWithoutHistory(i,r)}),e.add(Bing.AS.EventIds.UpdateText,function(t,i){n.raiseEvent(Bing.AS.EventIds.UpdateText,t,i)}),e.add(Bing.AS.EventIds.NavigateSerp,function(t,i){n.raiseEvent(Bing.AS.EventIds.NavigateSerp,t,i)}),e.add(Bing.AS.EventIds.NavigateLink,function(t,i,r,u,f,e){n.raiseEvent(Bing.AS.EventIds.NavigateLink,t,i,r,u,f,e)}),e.add(Bing.AS.EventIds.NoItemSelected,function(){n.raiseEvent(Bing.AS.EventIds.NoItemSelected)}),e.add(Bing.AS.EventIds.SelectPrevItem,function(t){n.raiseEvent(Bing.AS.EventIds.SelectPrevItem,t)}),e.add(Bing.AS.EventIds.SelectNextItem,function(t){n.raiseEvent(Bing.AS.EventIds.SelectNextItem,t)}),e.add(Bing.AS.EventIds.MouseEnterSuggestion,function(t){n.raiseEvent(Bing.AS.EventIds.MouseEnterSuggestion,t)}),e.add(Bing.AS.EventIds.MouseLeaveSuggestion,function(t){n.raiseEvent(Bing.AS.EventIds.MouseLeaveSuggestion,t)}),e.add(Bing.AS.EventIds.NoResults,function(){n.raiseEvent(Bing.AS.EventIds.NoResults)}),n.canvas.EventRegistry.push(e),n.raiseEvent(Bing.AS.EventIds.Initialized,this)},n.addApiOption=function(n){i.addApiOption(n)},n.apiCB=function(t){n.raiseEvent(Bing.AS.EventIds.ApiCallback);var u="",r=[],f,i=t.AS;e&&e.log(n,"ApiResponseReceived");try{if(u=i.Query,f=i.FullResults==1,r=i.Results,n.logMeta=i.LogMeta,n.currentQuery!=""&&u!=n.currentQuery)return;if(!r){n.canvas.currentSuggestionList=[],n.raiseEvent(Bing.AS.EventIds.NoResults);return}}catch(o){return}n.raiseEvent(Bing.AS.EventIds.ValidResponseReceived,u,r),rt(r,u)},n.setData=function(t){n.data=t},n.enabledPopularNow=function(t){n.popularNowEnabled=t},n.reset=function(){f.reset()},n.isPreviewPaneDisabled=function(){return u},n.getAllSuggestionInstUrl=function(n,t){for(var u=l(t),f=[],r,i=0;i<u.length;i++)r=w(u[i],!0,n),r!==null&&(f=f.concat(["&",u[i],"=",r]));return f.join("")},n.getAllSuggestionInstObject=function(n,t){for(var u=l(t),f={},r,i=0;i<u.length;i++)r=w(u[i],!1,n),r!==null&&(f[u[i]]=r);return f},n.setCursorPosition=function(n){b=n},n.setDataSet=function(n){this.config.ds=n},n.fetch=function(s){i.addParam(t.CursorPosition,b),u&&i.addParam(t.PreviewPaneDisabled,1),r.h&&n.currentQuery!=""&&i.addApiOptionN(o.HitHighlighting),n.popularNowEnabled&&i.addApiOptionN(o.PopularNow),f.setDataProviderCallParams(n.currentQuery,i),r.ds&&i.addParam(t.DataSet,r.ds),r.cnt&&r.cnt>0&&i.addParam(t.Count,r.cnt),r.asf&&!h&&i.addParam(t.Css,1),n.cssVersioningEnabled&&h&&i.addParam(t.CssVersion,n.cssVersioningMgr.getCssVersionList());var c=i.fetch(s);e&&e.log(n,"ApiRequestSent"),n.raiseEvent(Bing.AS.EventIds.RequestSent,n.currentQuery,c)},s=0;s<Bing.AS.AutoSuggest.ScopeExtensions.length;s++)Bing.AS.AutoSuggest.ScopeExtensions[s].init.apply(this)},Bing.AS.AutoSuggest.ScopeExtensions=[],Bing.AS.AutoSuggest.prototype.EventRegistry=[],Bing.AS.AutoSuggest.prototype.InstrumentationTypes=[],Bing.AS.AutoSuggest.prototype.setQuery=function(n){var t=this.config.eHS||this.popularNowEnabled?0:1;n.length>=t?(this.currentQuery=n,this.fetch(n)):this.raiseEvent(Bing.AS.EventIds.InvalidQuery)},Bing.AS.EventRegistration=function(){this.events=[],this.add=function(n,t){this.events[n]=t}},Bing.AS.AutoSuggest.prototype.raiseEvent=function(n){for(var r=arguments.length?[].slice.apply(arguments).slice(1):[],i,t=0;t<this.EventRegistry.length;t++)i=this.EventRegistry[t],i.events[n]&&i.events[n].apply(this,r)},Bing.AS.History=function(n){function o(){return n.eHS&&sj_cook.get(l,c)!="0"}function h(n){var r=o();return(r!=e&&t.reset(),e=r,!r)?!1:i?n.indexOf(i)!=0:!0}var f=AutoSuggest.Service.QueryParams,s=AutoSuggest.Service.Options,t=this;t.config=n;var l="_UR",c="OMW",v="_SS",a="SID",e=o(),i=null,r,u={};n.vid&&(u["hs.ds"]=n.vid),t.setDataProviderCallParams=function(t,i){var o,e;if(r||(r=sj_cook.get(v,a)),h(t)&&r){n.asf?i.addParam(f.Options,s.HistoryEnabled):(o=t==""?n.maxHSEQ:n.maxHS,o&&(u["hs.count"]=o),i.addParam(f.SessionId,r),i.addParam(f.TimeStamp,sb_gt()),i.addApiOptionN(s.HistoryEnabled));for(e in u)i.addParam(e,u[e])}},t.appendHistory=function(n,r,u){var e=0,o=t.getHistory(n,r),s={Type:"HS",Suggests:o},f;if(e=o.length,e){for(f=0;f<e;f++)s.Suggests[f].isHist=!0;r.splice(u?1:0,1,s)}else i=n},t.setQueryWithoutHistory=function(n,t){for(var u=!1,r=0;r<t.length;r++)if(t[r].stype&&t[r].stype=="HS"){u=!0;break}u||(i=n)},t.reset=function(){i=null}},Bing.AS.History.prototype.init=function(){},Bing.AS.History.prototype.getHistory=function(n,t){for(var i=0;i<t.length;i++)if(t[i].Type=="HS")return t[i].Suggests;return[]},Bing.AS.Utils=new function(){function i(n,t){if(n===t)return!1;while(t&&t!==n)t=t.parentNode;return t===n}var f=new RegExp(Bing.AS.Constants.HitHighlightStartToken,"gi"),u=new RegExp(Bing.AS.Constants.HitHighlightEndToken,"gi"),e=0,n,t=[],r=5;this.StripHighlighting=function(n){return n.replace(f,"").replace(u,"")},this.SetInnerText=function(n,t){if(n&&typeof t=="string"){var i="textContent";n[n[i]!==undefined?i:"innerText"]=t}},this.GetComputedStyle=function(n){return _w.getComputedStyle?_w.getComputedStyle(n,null):n.currentStyle},this.GetQueryStringParam=function(n,t){var r=new RegExp("[?&]{1}"+t+"=([^&]+)"),i=n.match(r);return i?i[1]:null},this.LoadScript=function(i){n=n||_d.getElementsByTagName("head")[0];var u=sj_ce("script");n.appendChild(u),u.src=i,t.push(u),t.length>=r&&n.removeChild(t.shift())},this.SetSelectionRange=function(n,t,i){if(n.setSelectionRange)n.setSelectionRange(t,i);else{var r=n.createTextRange();r.moveEnd("sentence",-1e5),r.moveStart("character",t),r.moveEnd("character",i-t),r.select()}},this.TruncateText=function(n,t){return n.length>t&&(n=n.substr(0,t-3),n=n.replace(/\s+$/g,"")+"..."),n},this.GetMouseCoords=function(n){return n=sj_evas(n),{x:n.clientX,y:n.clientY}},this.RewriteAttribsToProps=function(n,t){for(var i,r,u=0;i=t[u++];)r=n.getAttribute(i),r&&(n[i]=r)},this.MouseEnterLeave=function(n,t){return function(r){r=sj_evas(r);var u=r.relatedTarget||(r.type=="mouseout"?r.toElement:r.fromElement);t===u||i(t,u)||n.call(t,r)}},this.getCursorPosition=function(n,t){var u=0,e=_d.selection,o=n.selectionStart,i,r,f;return o!=null?u=o:e&&n.createTextRange&&(t&&n.focus(),i=n.createTextRange(),r=i.duplicate(),f=e.createRange(),t&&i.moveToBookmark(f.getBookmark()),r.setEndPoint("EndToStart",f),u=r.text.length),u},this.RemoveClassName=function(n,t){n&&(n.className=n.className.replace(t,""))},this.AddClassName=function(n,t){var r,i;if(n){for(r=n.className.split(" "),i=0;i<r.length;i++)if(r[i]===t)return;n.className.length>0&&(n.className+=" "),n.className+=t}}},_w.Bing=_w.Bing||{},Bing.AS=Bing.AS||{},Bing.AS.DataProvider=function(n,t,i){function s(t){var i=t,e,f;n.asf&&n.ds&&(e="/AS/Suggestions",i=i.replace(e,e+"/"+n.ds));for(f in r)i+="&"+f+"="+r[f];return r={},u=[],i}function w(n){h.push(n)}function v(n){u.push(n)}function f(n,t){r[n]=t}function c(n,t){var i=t?u:h.concat(u);f(AutoSuggest.Service.QueryParams.Query,encodeURIComponent(n)),f(AutoSuggest.Service.QueryParams.Options,i.join("+")),Bing.AS.Utils.LoadScript(s(a))}function l(t){var i=[].slice.call(arguments);return f(AutoSuggest.Service.QueryParams.ConversationId,_G.IG),i.unshift(s(decodeURIComponent(n.u)+encodeURIComponent(t))),o.apply(_w,i)}function o(n){var t=sj_gx(),r;return e++,r=[].slice.apply(arguments).slice(1),r.unshift(e),t.open("GET",n,!0),t.onreadystatechange=function(){if(t.readyState==4){t.onreadystatechange=function(){};var n=null;t.status==200&&(n=t.responseText),r.unshift(n),i.apply(_w,r)}},t.withCredentials!==undefined&&(t.withCredentials=!0),t.send(),e}var b=this,y=Bing.AS.Constants.PreviewPaneDataProvider,p=t==y?".apiECB":".apiCB",a=[decodeURIComponent(n.u),"&mkt=",n.mkt,"&type=cb&cb=",n.globalId,p].join(""),h=[],r={},u=[],e=0;return{addApiOption:w,addApiOptionN:v,addParam:f,fetch:n.asf?l:c,fetchUrl:o}},Bing.AS.Canvas=function(n,t,i){function ft(n){o=o||f.GetMouseCoords(n)}function lt(n,t){var i=f.GetMouseCoords(n);o&&(o.x!=i.x||o.y!=i.y)&&(o=i,t.className.indexOf(ct)==-1&&(r.highlightSuggestion(t),r.raiseEvent(Bing.AS.EventIds.MouseEnterSuggestion,t)))}function ii(n,t,i){for(var f=[],u=0,e,o=n.split(Bing.AS.Constants.HitHighlightStartToken),u=0;u<o.length;u++)f=f.concat(o[u].split(Bing.AS.Constants.HitHighlightEndToken));for(u=0;u<f.length;u++)f[u]&&(e=u%2==0?r.buildSuggestionSegment(f[u],i?"span":0,i):r.buildSuggestionSegment(f[u],"strong",i),t.appendChild(e))}function gt(n,t){var e=n.Type,f=r.SuggestionGroupBuilders[e],u,i;return f?f.call(r,n,t):(u=r.SuggestionBuilders[n.Type]||r.buildSuggestion,i=r.ce("li"),r.decorateSuggestion(i,n,t),i=u.call(r,n,i),!i)?!1:(n.SelectTxt||(n.SelectTxt=n.DisplayTxt),r.appendSuggestion(i,n),i)}function dt(){for(var f=r.suggestionsContainer.childNodes,i,t,n,u=0;u<f.length;u++)if(i=f[u],i.overflowElems)for(t=0;t<i.overflowElems.length;t++)n=i.overflowElems[t],n.offsetLeft+n.offsetWidth>r.suggestionsContainer.offsetWidth&&(n.style.display="none")}function kt(n,t){var i;return n?(i=n.getAttribute(h.Navigation))?t==e.right&&n.panel&&!n.panel.visible?void 0:i.split(";")[t]:void 0:a[t]}function y(n){var e,f;(e=kt(u,n))&&(e==t.i?(s(),r.unHighlightSuggestionHandler(),r.raiseEvent(Bing.AS.EventIds.NoItemSelected)):(f=r.ge(e),f&&(s(f),r.highlightSuggestion(f))))}function ti(){return f.getCursorPosition(ht)==ht.value.length}function w(n){for(var t=r.currentSuggestion;t=t[n];)if(!t.hd)return t;return null}function ut(n){n=sj_evas(n),sj_sp(n)}function rt(){return t.hn?"http://"+t.hn:""}function nt(n){at.test(n.className)||(n.className+=" "+ct)}function it(n){f.RemoveClassName(n,at)}function s(n){if(r.selectedSuggestion=n,!n||n.supressTextOnSelect)r.raiseEvent(Bing.AS.EventIds.UpdateText,b,!0);else{var t=n.query||r.currentSuggestionList[n.ord];!t&&n.panel&&(t=n.panel.suggestion.query),r.raiseEvent(Bing.AS.EventIds.UpdateText,t,n.isPPElem)}}function pt(n,i){return t.anc?null:(i.className=this.SuggestionClassName+" sa_2RowImg "+this.SuggestionClassName+n.Type,this.buildSuggestionImage(n,i),this.buildSuggestionTerm(n,i),this.buildSuggestionDescription(n,i),this.addSuggestionUrl(n,i),i.supressTextOnSelect=!0,i)}function wt(n){for(var u="script",o="src",e=k.getElementsByTagName(u),r,t,i,f;e.length;)k.removeChild(e[0]);for(r=n.getElementsByTagName(u);r.length;)t=sj_ce(u),i=r[0],t.type=i.type,f=i.getAttribute(o),f?t.setAttribute(o,f):(t.setAttribute("data-bing-script","1"),t.text=i.innerHTML),i.parentNode.removeChild(i),k.appendChild(t)}function vt(n){var s="style",e=n.getElementsByTagName(s),o,u,i,f;if(r.autoSuggestInstance.cssVersioningEnabled)r.autoSuggestInstance.cssVersioningMgr.storeStyles(n);else if(t.ic)for(o=r.document.getElementsByTagName("head")[0];e.length;)u=e[0],i=r.ce(s),o.appendChild(i),i.textContent!==undefined?i.textContent=u.innerHTML:i.styleSheet.cssText=u.innerHTML,n.removeChild(u);else for(f=0;f<e.length;f++)sj_ic(e[f].innerHTML)}var r=this,tt,g,v,d,p;r.autoSuggestInstance=n,r.config=t,r.container=i,r.currentRenderIndex=0,r.currentSuggestion,r.currentSuggestionList=[],r.selectedSuggestion,r.clickedSuggestion,r.suggestionTypesRendered,r.suggestionsContainer=i,r.document=t.ic&&t.asf?_ge("sa_con").contentWindow.document:_d,r.SuggestionClassName="sa_sg";var ct="sa_hv",at=/(\s|^)sa_hv/g,yt="sa_obd",bt=/(\s|^)sa_obd/g,et="sa_tm",f=Bing.AS.Utils,st=f.MouseEnterLeave,e={up:0,right:1,down:2,left:3},b,ni=t.m||5,o,ht=_ge(t.i),a=[],u,c,l,k=_ge(t.c||"sw_as"),h=AutoSuggest.Service.SuggestionAttributes,ot=new Bing.AS.EventRegistration;for(ot.add(Bing.AS.EventIds.Disposed,function(){Bing.AS.Canvas.prototype.EventRegistry=[]}),n.EventRegistry.push(ot),r.render=function(n,s,c){var y=0,d=[],tt,k,l,rt,it,p,v,g,nt,w;if(i.innerHTML="",b=s,r.currentSuggestionList=[],r.currentSuggestion=null,r.selectedSuggestion=null,u=null,o=null,r.currentRenderIndex=0,r.suggestionTypesRendered={},typeof n=="string"){if(r.InsertAjaxResponseIntoDom(i,n),r.autoSuggestInstance.cssVersioningEnabled&&r.autoSuggestInstance.cssVersioningMgr.updateStylesInDom(r.autoSuggestInstance.cssVersioningMgr.getVersion()),r.suggestionsContainer=r.ge(t.slid),r.suggestionsContainer){for(tt=r.suggestionsContainer.getElementsByTagName("li"),k=0;l=tt[k];k++)if(l.parentNode.id==t.slid){if(rt=/^https?:\/\/[^\/]+\/search|^\/search/,f.RewriteAttribsToProps(l,[h.Url,h.Query,h.Type,h.Autocomplete]),l.className.indexOf("pp_tile")!=-1&&(l.panel={ot:sb_gt()}),l.className.indexOf("sa_hd")!=-1){l.hd=!0,l=l.nextSibling;continue}if(l.className.indexOf("sa_bimg")!=-1&&(b.length||!r.config.eBID)){l=l.nextSibling;continue}r.currentSuggestionList.length==0&&(a[e.down]=l.id),typeof l.url=="string"&&(l.addInst=l.url.indexOf("/search")==0),r.currentSuggestionList.push(l.query),r.decorateSuggestion(l,{},y++),a[e.up]=l.id,d.push(l)}}else{r.raiseEvent(Bing.AS.EventIds.NoResults);return}n={}}else for(nt=Math.min(n.length,ni);y<nt;y++){if(v=n[y],!v)break;v.DisplayTxt=v.Txt,p=v.ServiceType,p!=g&&r.HeadingBuilders[p]&&(it=r.HeadingBuilders[p].call(r))&&r.addHeading(it,y==0),r.suggestionTypesRendered[v.Type]==null&&(r.suggestionTypesRendered[v.Type]=0),w=gt(v,r.currentRenderIndex),w&&(g=p,r.suggestionTypesRendered[v.Type]++,r.currentRenderIndex++,d.push(w))}r.raiseEvent(Bing.AS.EventIds.SuggestionsRendered,s,d,n,c,i),sb_st(dt,1)},r.appendSuggestion=function(n,t){var i=f.StripHighlighting(t.SelectTxt);n.query=i,r.suggestionsContainer.appendChild(n),r.currentSuggestionList.push(i)},r.decorateSuggestion=function(n,t,i){n.src=n.stype||t.Type,n.ord=i,n.sk=t.Sk,r.attachSuggestionEvents(n)},r.attachSuggestionEvents=function(n){if(sj_be(n,"mousemove",function(t){ft(t),lt(t,n)}),sj_be(n,"mouseover",st(function(t){ft(t),lt(t,n)},n)),sj_be(n,"mouseout",st(function(){if(n==u){var i=n.isPPElem?n.panel.suggestion:null;n.isPPElem&&r.unHighlightSuggestionHandler(n),u=i||u}r.raiseEvent(Bing.AS.EventIds.MouseLeaveSuggestion,n)},n)),sj_be(n,"mousedown",function(t){r.onMouseDownSuggestion(t,n)}),sj_be(n,"mouseup",function(t){ut(t);r.onMouseUpSuggestion(t,n)}),t.asf){var i=window.navigator.msPointerEnabled?"onMSPointerDown":"ontouchstart";i.toLowerCase()in _w&&sj_be(n,i.substr(2),function(t){if(o={x:0,y:0},n.it="m",t.pointerType)switch(t.pointerType){case t.MSPOINTER_TYPE_TOUCH:n.it="t";break;case t.MSPOINTER_TYPE_PEN:n.it="p"}else n.it="t"})}},r.buildSuggestionTerm=function(n,t,i){var f=et,u;n.isHist&&(f+=" "+et+"HS"),u=r.ce(i||"div","",f),n.Type=="ID"&&(u.lang="en"),t.appendChild(u),ii(n.DisplayTxt,u)},r.buildSuggestionDescription=function(n,t,i){n.Meta1&&t.appendChild(r.buildSuggestionSegment(n.Meta1,i||"div","sa_ds"))},r.buildSuggestionImage=function(n,t,i){if(n.Img){var e=r.ce(i||"div","","sa_img"),u=r.ce("img"),f=n.Img.alt;f&&(u.title=f),u.src=rt()+n.Img.src,u.width=n.Img.w,u.height=n.Img.h,e.appendChild(u),t.appendChild(e)}},r.addSuggestionUrl=function(n,i){n.Url&&(i.url=rt()+n.Url+(t.fc?"&FORM="+t.fc:""),i.addInst=!0)},r.buildSuggestionSegment=function(n,t,i){var u=t?r.ce(t,"",i):r.document.createTextNode(n);return t&&f.SetInnerText(u,n),u},r.handleArrowUpKey=function(n){if(t.asf)y(e.up,n),r.currentSuggestion&&r.raiseEvent(Bing.AS.EventIds.SelectPrevItem,r.currentSuggestion);else{var i=r.suggestionsContainer.lastChild;if(r.currentSuggestion&&!(i=w("previousSibling"))){s(),r.unHighlightSuggestionHandler(),r.raiseEvent(Bing.AS.EventIds.NoItemSelected);return}s(i),r.highlightSuggestion(i)}},r.handleArrowDownKey=function(n){if(t.asf)y(e.down,n),r.currentSuggestion&&r.raiseEvent(Bing.AS.EventIds.SelectNextItem,r.currentSuggestion);else{var i;if(!(r.currentSuggestion&&(i=w("nextSibling")))){if(r.currentSuggestion){s(),r.unHighlightSuggestionHandler(),r.raiseEvent(Bing.AS.EventIds.NoItemSelected);return}i=r.currentSuggestion=r.suggestionsContainer.firstChild,i.hd&&(i=w("nextSibling"))}s(i),r.highlightSuggestion(i)}},r.handleArrowRightKey=function(n){t.asf&&ti()&&!tt()&&(y(e.right,n),u&&u.isPPElem&&sj_pd(n))},r.handleArrowLeftKey=function(n){t.asf&&(u&&u.isPPElem&&sj_pd(n),y(e.left,n))},r.handleDiscardedGhosted=function(){if(u){r.unHighlightSuggestionHandler();var t=_ge(a[e.down]);t&&r.highlightObdSuggestion(t)}},tt=function(){return t.gst?(l||(l=_ge("sa_ghostbox")),l?l.value:null):null},r.highlightSuggestion=function(n){c?(f.RemoveClassName(c,bt),c=null):r.unHighlightSuggestionHandler(n),r.currentSuggestion=n.isPPElem?n.panel.suggestion:n,nt(r.currentSuggestion),r.currentSuggestion!=n&&nt(n),u=n},r.highlightObdSuggestion=function(n){f.AddClassName(n,yt),c=n},r.unHighlightSuggestionHandler=function(n){u&&(n&&n.isPPElem&&n.panel.suggestion==r.currentSuggestion||(it(r.currentSuggestion),r.currentSuggestion=null),(u.isPPElem||!r.currentSuggestion)&&it(u),u=null)},r.onMouseDownSuggestion=function(n,t){n=sj_evas(n);var i=n.button;i==2?(ut(n),sj_pd(n)):r.clickedSuggestion=t},r.onMouseUpSuggestion=function(n,t){n=sj_evas(n),t.isPPElem&&n.button!=2&&(r.clickedSuggestion=t),r.clickedSuggestion&&r.clickedSuggestion==t&&(s(r.clickedSuggestion),t.url?r.raiseEvent(Bing.AS.EventIds.NavigateLink,t.url,t.addInst,t.redir,t.query,!1,this.config.eNT):r.raiseEvent(Bing.AS.EventIds.NavigateSerp,t.query),r.clickedSuggestion=null)},g=["DT","IG","MV","SA","SI","SN","SP","SR","TC","TR","WE","WH","WM","WU","ID","NAV"],v=0;v<g.length;v++)d=g[v],this.SuggestionBuilders[d]=pt,Bing.AS.AutoSuggest.prototype.InstrumentationTypes.push(d);for(p=0;p<Bing.AS.Canvas.ScopeExtensions.length;p++)Bing.AS.Canvas.ScopeExtensions[p].init.apply(this);r.InsertAjaxResponseIntoDom=function(n,t){var i,u,f;if(t){for(i=r.ce("div"),i.innerHTML="<br>"+t,u=i.childNodes,i.removeChild(u[0]),wt(i),vt(i),f=r.document.createDocumentFragment();u.length;)f.appendChild(u[0]);n.appendChild(f)}},r.ge=function(n){return t.ic?r.document.getElementById(n):_ge(n)},r.ce=function(n,t,i){var u=r.document.createElement(n);return t&&(u.id=t),i&&(u.className=i),u}},Bing.AS.Canvas.ScopeExtensions=[],Bing.AS.Canvas.prototype.HeadingBuilders={},Bing.AS.Canvas.prototype.SuggestionBuilders={},Bing.AS.Canvas.prototype.SuggestionGroupBuilders={},Bing.AS.Canvas.prototype.buildSuggestion=function(n,t){return t.className=this.SuggestionClassName+(this.suggestionsContainer.childNodes.length==0?" sa_sg_first ":" ")+this.SuggestionClassName+n.Type,this.buildSuggestionTerm(n,t),this.addSuggestionUrl(n,t),t.hc=n.HC,t.hcs=n.HCS,t},Bing.AS.Canvas.prototype.addHeading=function(n,t){var i=sj_ce("li","","sa_hd"+(t?"_first":""));i.hd=!0,i.innerHTML=n,this.suggestionsContainer.appendChild(i)},Bing.AS.Canvas.prototype.HeadingBuilders.PN=function(){return this.config.ePN?sa_loc.H_PN:null},Bing.AS.Canvas.prototype.HeadingBuilders.AS=function(){return this.config.eWH?sa_loc.H_AS:null},Bing.AS.Canvas.prototype.EventRegistry=[],Bing.AS.Canvas.prototype.raiseEvent=Bing.AS.AutoSuggest.prototype.raiseEvent,Bing.AS.Layout=function(n,t){function h(n,t){n.appendChild(t)}function u(n){var t=parseFloat(n);return isNaN(t)?0:t}var o=this,a=n.asf,y=Bing.AS.Utils.GetComputedStyle(sj_b).direction=="rtl",s=a&&n.ic,v=_ge(n.i),r,f,e,c,l;s?(t.style.position="relative",r=sj_ce("iframe","sa_con"),r.setAttribute("frameBorder","0"),r.setAttribute("scrolling","no"),r.style.width="100%",r.style.height=0,r.style.border="none",r.style.position="absolute",r.style.top="1px",h(t,r),e=r.contentWindow.document,e.open(),e.write('<!doctype html public "-//w3c//dtd xhtml 1.0 transitional//en" "http://www.w3.org/tr/xhtml1/dtd/xhtml1-transitional.dtd">'),e.write("<html><head><\/head><body><\/body><\/html>"),e.close(),c=e.createElement("div"),c.id=n.c,c.style.display="block",f=e.createElement("div"),f.className="sa_as",f.style.display="block",h(c,f),h(e.body,c)):(f=sj_ce("div","","sa_as"),h(t,f)),a||(l=sj_ce("ul","sa_ul","sa_drw"),h(f,l)),o.getSuggestionsContainer=function(){return a?n.ic?r.contentWindow.document.getElementById(n.slid):_ge(n.slid):l},o.getSuggestionsDrawer=function(){return f},o.show=function(){f.style.display="block"},o.hide=function(){s?r.style.height=0:f.style.display="none"},o.updateHeight=function(){s&&(r.style.height=0,r.style.height=r.contentWindow.document.getElementById("sw_as").firstChild.scrollHeight+2+"px")},o.update=function(){var i,r,n=Bing.AS.Utils.GetComputedStyle(t.parentNode);y?(r=(u(n.paddingRight)+u(n.borderRightWidth))*-1,i=s?(u(n.borderLeftWidth)+u(n.paddingLeft))*-1:u(n.borderLeftWidth)-u(n.paddingLeft)):(i=(u(n.paddingLeft)+u(n.borderLeftWidth))*-1,r=s?(u(n.borderRightWidth)+u(n.paddingRight))*-1:u(n.borderRightWidth)-u(n.paddingRight)),t.style.marginLeft=i+"px",t.style.marginRight=r+"px",o.updateHeight(),v!=null&&v.dir.length>0&&(f.dir=v.dir)}},Bing.AS.Layout.prototype.EventRegistry=[],Bing.AS.Layout.prototype.raiseEvent=Bing.AS.AutoSuggest.prototype.raiseEvent,Bing.AS.Layout.prototype.getLeft=function(){return 0},Bing.AS.Layout.prototype.getWidth=function(){return 0},Bing.AS.SearchForm=function(n){function vt(n){return typeof n=="number"?n:'"'+n.replace(/"/g,'\\"')+'"'}function a(u,f,e){var o,l,w,p,k,v,g,h,a,y,s;if(n.sbt){for(;w=b.shift();)t.searchForm.removeChild(w);b=[]}for(f&&t.raiseEvent(Bing.AS.EventIds.GhostingSubmit),c=i.getAllSuggestionInstObject(null,f),t.raiseEvent(Bing.AS.EventIds.BeforeNavigate),p=ui(e),o=_ge("sa_ghc"),o&&o.parentElement.removeChild(o),k=0,g=[c,p];v=g[k++];)for(h in v)o=_ge("sa_"+h),l=v[h],o?o.value=l:t.addHiddenField(h,l);i.ghostInstValue=0,st?st(r,c):(f||sj_evt.fire("onSearch",t.searchForm),a=i.canvas.selectedSuggestion,n.ic&&n.asf&&a&&_w.sa_si_T(a.getAttribute("id")),d(),t.fireEvt?(y=t.searchForm.getAttribute("action"),e&&t.searchForm.setAttribute("action",e),t.searchForm.submit(),nt(f),y&&t.searchForm.setAttribute("action",y)):t.searchForm.submit()),t.fireEvt&&(t.autosuggest.canvas.selectedSuggestion=null,t.autosuggest.ghostInstValue=0,s=_ge("sa_ghc"),!c.ghc&&s&&s.parentNode.removeChild(s))}function d(){var r,i;ht&&n.eUG||(r=t.searchForm.getAttributeNode("onsubmit"),r&&_w.si_T&&(i=r.value.match(/si_T\('(.*)'\)/),i&&i[1]&&si_T(i[1])),ht=!0)}function tt(r,u,e,o,s,h){var l,c;if(sb_st(f,5),o!=undefined&&p(o),e)sj_cook.set("SCRHDN","ASD","1"),sj_cook.set("SCRHDN","DURL",r),a(o,s);else{if(i.config.asf){if(n.sbt){a(o,s,r);return}l=i.canvas.selectedSuggestion,n.ic&&n.asf&&l&&_w.sa_si_T(l.getAttribute("id")),n.eUG?d():(t.searchForm.onsubmit&&t.searchForm.onsubmit(),nt(s))}c=r+(u?i.getAllSuggestionInstUrl():""),h?_w.open(c,"_blank"):typeof sj_lc!="undefined"?sj_lc(c):_w.location=c}}function nt(n){!n&&t.fireEvt&&t.fireEvt(t.searchForm,"ASSugClicked")}function ui(n){var u={},t;if(n)for(var i,f=/\+/g,o=/([^&=]+)=?([^&]*)/g,r=function(n){return decodeURIComponent(n.replace(f," "))},e=n.substring(n.indexOf("?")+1);i=o.exec(e);)t=r(i[1]).toLowerCase(),t!=="q"&&t!=="form"&&(u[t]=r(i[2]));return u}function it(n,i){n(sj_b,"click",v),n(sj_b,"touchend",v),n(t.searchForm,"submit",li),n(r,"keydown",ai),n(r,"keyup",ci),n(r,"click",ft),t.fireEvt&&n(_w,"blur",v),i("focusChange",ii),i("hideDrawer",f)}function li(n){var r,u;sb_st(f,5),t.cdh(n),r=i.canvas.selectedSuggestion,r?(i.config.asf&&!i.config.ic&&_w.sa_si_T(r.getAttribute("id")),u=r.query,r.url?tt(r.url,r.addInst,r.redir,u,!0,t.config.eNT):a(u,!0)):a(i.currentQuery,!0)}function ai(n){t.cancelKeyEvent(n)||et(n)}function et(n){var r=n.keyCode;switch(r){case e.KeyCodeEscape:t.config.eAI?(u&&(v(n),sj_sp(n)),sj_pd(n)):(f(),t.cdh(n));break;case e.KeyCodeArrowUp:u&&(i.canvas.handleArrowUpKey(n),t.cdh(n));break;case e.KeyCodeArrowDown:u?i.canvas.handleArrowDownKey(n):rt();break;case e.KeyCodeArrowRight:u&&i.canvas.handleArrowRightKey(n);break;case e.KeyCodeArrowLeft:u&&i.canvas.handleArrowLeftKey(n);break;case e.KeyCodeTab:t.config.asf&&t.fireEvt&&v(n)}}function ci(n){var i=n.keyCode;l||t.cancelKeyEvent(n)||(i==e.KeyCodeArrowUp||i==e.KeyCodeArrowDown||i==e.KeyCodeEscape)&&t.handleUpDownEscOnKeyUp(n)&&et(n)}function ft(){u?t.shouldHidePanel()&&f():rt()}function rt(){(h&&sb_ct(h),l)||(t.lastQuery=null,pt(t.getCurrentQuery()))}function si(){o.update(),u||(sj_evt.fire("focusChange",r),o.show(),u=!0,t.raiseEvent(Bing.AS.EventIds.DropDownShown),sb_i6&&sj_evt.fire("autosuggestShown",r),sj_evt.fire("onPopTR"))}function v(n){sj_sp(n),f()}function f(){u&&(o.hide(),dt=u=!1,t.lastQuery=t.getCurrentQuery(),t.raiseEvent(Bing.AS.EventIds.DropDownHidden),sb_i6&&sj_evt.fire("autosuggestHide",r))}function ii(n){n[1]!==r&&f()}function kt(){h=sb_st(f,50)}function bt(n){t.updateText(n)}function p(n,t){var i=t?n+t:n,u;r.prefixLength=t?n.length:null,i!==null&&(r.value=i,at||r.setAttribute("value",i),u=i.length,lt(r,u,u))}function wt(n,t){if(s=!0,p(n),!t){var i=n.length;r.focus(),lt(r,i,i)}}function ni(n,t,i){s=i===undefined?!0:i,p(n,t)}function k(){var n,i;l||(n=t.getCurrentQuery(),t.lastQuery==n&&s||at||r.setAttribute("value",n),s?pt(n):(t.lastQuery=n,s=!0),i=yt,ct&&(i*=1<<Math.max(0,w-hi+1)/2)),oi=sb_st(k,i)}function pt(n){if(t.lastQuery!=n){if(n.length<ei){f();return}t.shouldHidePanel()?f():(h&&sb_ct(h),i.setCursorPosition(t.getCursorPosition()),i.setQuery(n),t.lastQuery=n,w++)}}function gt(){w--}function ti(){Bing.AS.SearchForm.prototype.EventRegistry=[],it(sj_ue,sj_evt.unbind),sb_ct(k),sb_ct(h)}var t=this,y;t.raiseEvent(Bing.AS.EventIds.ConfigurationSet,n),t.config=n,t.searchForm=null,t.searchBox=null,t.autosuggest=null,t.layout=null,t.lastQuery="",t.DemoQuery="asdemoq",t.DemoPath="asdemopath";var ot="SRCHHPGUSR",ut="AS",hi=4,g,i,o,yt=0,ct,w=0,ei=n.eHS||n.ePN?0:1,h,l,dt,u,r,s=!0,e=Bing.AS.Constants,c,b=[],oi,lt=Bing.AS.Utils.SetSelectionRange,ht,at=sb_ie&&sb_de.style.opacity===undefined,fi=new RegExp("^\\s*","g"),ri=new RegExp("\\s+","g"),st=typeof n.cb=="function"?n.cb:null;for(t.init=function(u){var y,c,s,v,p,f,e,h;(t.config.globalId=u,t.config.slid="sa_ul",l=t.isDisabled())||(g=n.i,t.searchForm=_ge(n.f),r=_ge(g),t.searchBox=r,n.asf&&n.SBW&&_ge("hp_container")&&(y=_w.innerWidth||sb_de.clientWidth,y<=1024&&(c=_ge(n.c),c&&(c.className+=" sa_n",n.SBW-=30))),t.searchForm.form&&(n.fc=t.searchForm.form.value),sj_cook.set("SCRHDN","ASD","0"),sj_cook.set("SCRHDN","DURL","#"),s=_ge(n.c||"sw_as"),s.style.display="block",t.layout=o=new Bing.AS.Layout(n,s,r.parentNode),t.registerUIElement(s),t.registerUIElement(r),v=_ge("sb_form_go"),v&&t.registerUIElement(v),yt=n.d,ct=n.t,n.ol||(t.lastQuery=t.getCurrentQuery()),p=n.asf?o.getSuggestionsDrawer():o.getSuggestionsContainer(),t.autosuggest=i=new Bing.AS.AutoSuggest,i.init(n,p),f=new Bing.AS.EventRegistration,f.add(Bing.AS.EventIds.ApiCallback,gt),f.add(Bing.AS.EventIds.NoResults,kt),f.add(Bing.AS.EventIds.SuggestionsRendered,si),f.add(Bing.AS.EventIds.UpdateText,bt),f.add(Bing.AS.EventIds.UpdateTextAndRequery,wt),f.add(Bing.AS.EventIds.UpdateGhostedText,ni),f.add(Bing.AS.EventIds.NavigateSerp,a),f.add(Bing.AS.EventIds.NavigateLink,tt),f.add(Bing.AS.EventIds.Disposed,ti),i.EventRegistry.push(f),e=new Bing.AS.EventRegistration,e.add(Bing.AS.EventIds.SelectPrevItem,function(n){t.raiseEvent(Bing.AS.EventIds.SelectPrevItem,n)}),e.add(Bing.AS.EventIds.SelectNextItem,function(n){t.raiseEvent(Bing.AS.EventIds.SelectNextItem,n)}),i.canvas.EventRegistry.push(e),it(sj_be,sj_evt.bind),k(),t.raiseEvent(Bing.AS.EventIds.Initialized,t),h=_w.location.search,n.demo&&(Bing.AS.Utils.GetQueryStringParam(h,t.DemoQuery)||Bing.AS.Utils.GetQueryStringParam(h,t.DemoPath))&&(Bing.AS.Utils.LoadScript("/fd/sa/"+_G.Ver+"/AutoSuggest/AutoSuggestDemo.js"),sj_evt.fire("onASDemo",t)))},t.apiCB=function(n){t.autosuggest.apiCB(n)},t.setData=function(n){t.autosuggest.setData(n)},t.isDisabled=function(){return sj_cook.get(ot,ut)==0},t.enable=function(n,i){n&&(t.lastQuery=t.getCurrentQuery()),l=!n,i||sj_cook.set(ot,ut,n?1:0,1,"/")},t.sid=function(t){i.config.sid=n.sid=t},t.registerUIElement=function(n){sj_be(n,"touchend",sj_sp),sj_be(n,"click",sj_sp)},t.addHiddenField=function(i,r){var u=sj_ce("input");return u.id="sa_"+i,u.name=i,u.value=r,u.type="hidden",t.searchForm.appendChild(u),n.sbt&&b.push(u),u},t.drawerIsOpen=function(){return u},t.cp=0,t.cdh=function(n){sj_sp(n),sj_pd(n)},t.setAllSuggestionInstObject=function(n){c=n},t.addToAllSuggestionInstObject=function(n,t){c[n]=t},t.show=ft,t.getCursorPosition=function(){return t.cp=Bing.AS.Utils.getCursorPosition(r,!0)},_w.sa_si_T=function(r){var u=i.canvas.ge(r.replace("&","")),o,e,f,s;return u&&document.images&&(o=u.getAttribute("h"),f={a:[],add:function(n,t){this.a.push(vt(n)+":"+vt(t))},get:function(){return this.a.length?"&PR={"+this.a.join(",")+"}":""}},f.add("i",i.canvas.clickedSuggestion?u.it||"m":"k"),i.ghostInstValue&&f.add("ghc",i.ghostInstValue),(u.isPPElem||u.panel)&&f.add("et",sb_gt()-u.panel.ot),e=t.autosuggest.data&&t.autosuggest.data.Inst?t.autosuggest.data.Inst.IG:null,e&&o&&(s=new Image,s.src=_G.gpUrl+"IG="+e+"&"+o+f.get()),n.eUG&&d()),!0},t.updateText=function(n){s=!1,p(n)},t.getCurrentQuery=function(n){var t=r.prefixLength?r.value.substr(0,r.prefixLength):r.value;return n?t:t.replace(fi,"").replace(ri," ").toLowerCase()},y=0;y<Bing.AS.SearchForm.ScopeExtensions.length;y++)Bing.AS.SearchForm.ScopeExtensions[y].init.apply(t)},Bing.AS.SearchForm.ScopeExtensions=[],Bing.AS.SearchForm.prototype.EventRegistry=[],Bing.AS.SearchForm.prototype.cancelKeyEvent=function(){return!1},Bing.AS.SearchForm.prototype.handleUpDownEscOnKeyUp=function(){return!1},Bing.AS.SearchForm.prototype.raiseEvent=Bing.AS.AutoSuggest.prototype.raiseEvent,Bing.AS.SearchForm.prototype.shouldHidePanel=function(){return!1},Bing.AS.SearchForm.ScopeExtensions.push(new function(){this.init=function(){function g(){var u,f;t=o.searchBox,i=Bing.AS.Utils.GetComputedStyle(t),n.style.fontSize=i.fontSize,n.style.fontFamily=i.fontFamily,n.style.position="absolute",t.parentNode.insertBefore(n,t.nextSibling),l=Bing.AS.Utils.GetComputedStyle(t.parentNode),u=new Bing.AS.EventRegistration,u.add(r.ApiServiceReceived,rt),u.add(r.SuggestionsRendered,ut),u.add(r.NoResults,y),u.add(r.UpdateText,w),u.add(r.Disposed,b),f=o.autosuggest,f.EventRegistry.push(u),f.addApiOption(nt)}function e(n){return n.indexOf("px")>0?parseFloat(n):n.indexOf("em")>0?parseFloat(n)*(i.fontSize.indexOf("px")>0?parseInt(i.fontSize):16):0}function ft(){return e(i.paddingLeft)+e(i.marginLeft)+e(l.paddingLeft)}function et(n){return e(l.paddingTop)+e(i.marginTop)+n+(t.offsetHeight-n)/2-1}function rt(n){u=n.Type==it?n.Suggests:null}function ut(n,t){var r=t.length>0&&t[0].hc,i=function(){p(r)};s=sb_st(i,5)}function p(n){var f,e,i,t,r;if(y(),!n){if(u)for(t=0;t<u.length;t++)f=parseInt(u[t].Meta1),e=parseInt(u[t].Meta2),f!=NaN&&e!=NaN&&v(f,e);if(i=o.autosuggest.data,i&&i.Speller&&i.Speller.Corrections)for(t=0;r=i.Speller.Corrections[t++];)v(r.From,r.To)}}function y(){for(var n=0;n<f.length;n++)t.parentNode.removeChild(f[n]);f=[]}function w(){for(var i=o.autosuggest.currentQuery==t.value?"block":"none",n=0;n<f.length;n++)f[n].style.display=i}function v(i,r){var e,o,u;Bing.AS.Utils.SetInnerText(n,t.value.substring(i,r)),a(),e=n.offsetWidth,o=n.offsetHeight,h(),u=sj_ce("div","","sa_spell"),u.style.width=e+"px",u.style.height=k+"px",u.style.left=d(i)+"px",u.style.top=et(o)+"px",u.style.position="absolute",u.style.background="url(/fd/s/as_spell_underline.png)",t.parentNode.appendChild(u),f.push(u)}function d(i){Bing.AS.Utils.SetInnerText(n,t.value.substring(0,i)),n.innerHTML=n.innerHTML.replace(tt,"&#160;"),a();var r=n.offsetWidth;return h(),r+ft()}function a(){n.style.display="inline"}function h(){n.style.display="none"}function b(){s&&sb_ct(s)}var c;if(this.config.spr){var r=Bing.AS.EventIds,k=3,nt="qr",it="QR",tt=new RegExp(" ","g"),o=this,t,u,f=[],i,l,s,n=sj_ce("span");h(),c=new Bing.AS.EventRegistration,c.add(r.Initialized,g),this.EventRegistry.push(c)}}}),Bing.AS.SearchForm.ScopeExtensions.push(new function(){var nt=_w.location.search.indexOf("AutoSuggestTestHook_AlwaysGhost=1")>-1,t,p,b,k,n,i,l,c=0,a=0,v=0,tt=new RegExp("[-']","g"),e=Bing.AS.Utils.SetSelectionRange,rt=1,it=2,g,d=!1,y=!1,w=!1,r,f,o,u,s,h;Bing.AS.Constants.KeyCodeEnter=13,Bing.AS.Constants.KeyCodePageUp=33,Bing.AS.Constants.KeyCodePageDown=34,Bing.AS.Constants.KeyCodeEnd=35,Bing.AS.Constants.KeyCodeHome=36,Bing.AS.Constants.KeyCodeInsert=45,Bing.AS.Constants.GhostingDelayResponse=0,Bing.AS.Constants.GhostingDelayArrowKey=15,r=Bing.AS.Constants,f=Bing.AS.EventIds,this.init=function(){function gt(i){var r,s,o,e;i.config.eHC&&(u=i.autosuggest,u.ghostInstValue=0,r=new Bing.AS.EventRegistration,r.add(f.SuggestionsRendered,ei),r.add(f.Disposed,kt),u.EventRegistry.push(r),u.addApiOption("hc"),t=i.searchBox,ot.add(f.GhostingSubmit,dt),g=t.style.width,ot.add(f.DropDownHidden,ri),s=Bing.AS.Utils.GetComputedStyle(t),b=s.color,k=s.backgroundColor,n=sj_ce("input","sa_ghostbox",t.className+" sa_ghostbox"),n.setAttribute("autocomplete","off"),o=t.getAttribute("type"),o&&n.setAttribute("type",o),i.registerUIElement(n),n.tabIndex=-1,n.style.zIndex=-1,n.style.position="absolute",e=Bing.AS.Utils.GetComputedStyle(t.parentNode),n.style.left=e.paddingLeft,n.style.top=e.paddingTop,ht(sj_be))}function ht(i){i(n,"keydown",fi),i(n,"keyup",hi),i(n,"focus",oi),i(n,"mouseup",ti),i(n,"mousedown",ii),i(n,"select",at),i(n,"selectstart",at),i(sj_b,"mouseup",ui),i(t,"focus",ft),i(t,"keydown",ni),u.config.smg&&i(t,"keypress",bt),i(t,"compositionstart",wt),i(t,"compositionend",si)}function wt(){y=!0}function si(){y=!1,w&&(w=!1,sb_ct(l),l=sb_st(vt,r.GhostingDelayResponse))}function ei(n,t){p=t,!c&&u.currentQuery&&(y?w=!0:l=sb_st(vt,r.GhostingDelayResponse))}function vt(){var v,l,f,w,h,s,r,a;if(d||(v=t.parentNode,v.insertBefore(n,v.firstChild),d=!0),s=t.value,r=s.length,o.cp==r&&!c&&!y){if(nt)l=p[0];else for(a=0;a<p.length;a++)if(f=p[a],f.src!=null&&(w=f.src.toLowerCase()),f.hc){l=f;break}if(!l){ut(),ft(),ct();return}(i=l.query,h=s.toLowerCase(),i=i.toLowerCase(),i.indexOf(h)==0||(i=i.replace(tt,""),i.indexOf(h)==0&&i!=h))&&(lt(),n.value=s+i.substring(r),i=n.value,i.substring(r).length==0&&(ut(),ft(),ct()),i!=null&&(e(n,r,i.length),n.focus(),o.raiseEvent(Bing.AS.EventIds.GhostedSuggestion,i,w)),i!=null&&u.ghostInstValue==0&&(u.ghostInstValue=rt))}}function ri(){ft(),o.config.SBW&&(n.style.width=g),ut()}function ui(){a&&yt(),a=0,v=0}function ti(){v&&(a||e(n,i.length,i.length),yt(),t.focus()),a=0,v=0}function ii(){v=1}function at(){v&&(a=1)}function fi(n){var f=n.keyCode,s;if(c=0,f==r.KeyCodeBackspace?c=1:n.keyCode==r.KeyCodeArrowUp?u.canvas.handleArrowUpKey(n):n.keyCode==r.KeyCodeArrowDown&&u.canvas.handleArrowDownKey(n),i){if(f==r.KeyCodeDelete||f==r.KeyCodeBackspace||f==Bing.AS.Constants.KeyCodeEscape||n.keyCode==88&&n.ctrlKey){f==r.KeyCodeBackspace&&o.cdh(n),u.canvas.handleDiscardedGhosted(n),ut(),st();return}if(f==65&&n.ctrlKey){et(1),ut(),t.focus();return}if(f==r.KeyCodeHome||f==r.KeyCodePageUp){n.shiftKey||(et(),e(t,0,0),t.focus(),pt());return}if(n.keyCode==r.KeyCodeArrowUp||n.keyCode==r.KeyCodeArrowDown){ft(),ut(),t.focus(),s=t.value.length,e(t,s,s);return}if(f==r.KeyCodeTab){o.cdh(n),et(1),ut(),ft(),t.focus();return}if(f==r.KeyCodeTab){sj_evt.fire("hideDrawer",t),st();return}if(f==r.KeyCodeArrowLeft){o.cdh(n),s=t.value.length,et(),e(t,s,s),t.focus(),ut();return}if(f==r.KeyCodeEnd||f==r.KeyCodePageDown||f==r.KeyCodeArrowRight){et(1),ut(),ft(),t.focus();return}if(n.ctrlKey&&f==86){t.focus(),ut(),e(t,t.value.length,t.value.length),o.config.eAI&&sj_sp(n);return}n.altKey||n.ctrlKey||f>r.KeyCodeEnter&&f<r.KeyCodeSpace||f==r.KeyCodeInsert||f==91||f==93||f>=112&&f<=123||f==144||f==145||st()}}function st(){s=n.selectionStart,h=n.selectionEnd,t.focus(),e(t,t.value.length,t.value.length)}function hi(n){if(n.shiftKey&&(n.keyCode==r.KeyCodeHome||n.keyCode==r.KeyCodePageUp||n.keyCode==r.KeyCodeArrowLeft)){var i=t.value.length;et(),ft(),e(t,0,i),t.focus()}}function yt(){var l=n.value,r,s;sb_st(function(){n.value!=l&&u.raiseEvent(f.UpdateTextAndRequery,n.value)},1);var c=_d.selection,h=n.selectionStart,o=n.selectionEnd;c&&n.createTextRange&&(r=n.createTextRange(),s=c.createRange(),h=r.text.length-s.text.length,o=r.text.length),et(),t.focus(),e(t,h,o),ft(),i=null}function oi(){var n=_ge("sw_b");n&&(n.style.borderColor="#3366bb")}function ni(n){c=0,sb_ct(l),ft(),i=null;var t=n.keyCode;(t==r.KeyCodeDelete||t==r.KeyCodeBackspace||t==88&&n.ctrlKey)&&(c=1)}function bt(r){var a,c,l,o;i&&r.charCode!=0&&r.charCode!=13&&h>s&&(a=n.value.substring(s,h),c=String.fromCharCode(r.charCode),a[0].toLowerCase()==c.toLowerCase()?(u.raiseEvent(f.UpdateTextAndRequery,t.value+c,!0),l=t.value,o=l.length,t.value.length<n.value.length?(lt(),n.focus(),n.value=l+i.substring(o),e(n,o,i.length),s=o,h=i.length):ut(),r.preventDefault()):(n.value=n.value.substring(0,s),s=h=n.value.length),s==h&&(i=null))}function et(n){i&&(u.raiseEvent(n?f.UpdateTextAndRequery:f.UpdateText,i,!0),u.ghostInstValue=it)}function ft(){t.style.color=b,t.style.backgroundColor=k,n.style.zIndex=-1,n.style.color="transparent"}function ct(){sb_st(function(){t.focus()},1)}function lt(){t.style.color="transparent",t.style.backgroundColor="transparent",n.style.zIndex=2,n.style.color=b,o.config.SBW&&(n.style.width=o.config.SBW+"px")}function ut(){i=null,n&&n.value&&(n.value=""),pt()}function dt(){et(1)}function pt(){s=0,h=0}function kt(){ht(sj_ue),sb_ct(l)}o=this;var ot=new Bing.AS.EventRegistration;ot.add(f.Initialized,gt),this.EventRegistry.push(ot)}}),function(n){n&&(n.prototype.PreviewPaneManager={},n.ScopeExtensions.push(new function(){this.init=function(){var n=new Bing.AS.EventRegistration;n.add(Bing.AS.EventIds.Initialized,function(){Bing.AS.PreviewPaneManager.init(this)}),this.EventRegistry.push(n)}}))}(Bing.AS.SearchForm),Bing.AS.PreviewPaneManager=function(){function ni(){o(c);for(var u=0,r;r=e[u++];)o(r.timeoutTimer);e={},n=""}function oi(n,r){var e=i.layout.getSuggestionsContainer(),f,u;for(e.style.height="",d(e.parentNode,ct),f=0;u=r[f++];)u.ord!==undefined&&(hi(u),t.showForFirst&&u.panel!==undefined&&f==1&&a(u))}function hi(n){var t=r.currentSuggestionList[n.ord];n.getAttribute("hvid")&&it(n,t)}function ut(t){var i=e[n];t.panel&&(t.panel==i?i=null:a(t,!0)),n=t.query,i&&g(i,!0)}function a(i,u){var s,f,a;if(h.isPreviewPaneDisabled()){n=r.currentSuggestionList[i.ord];return}if(i.isPPElem){l(i.panel,u),n=i.panel.suggestion.query;return}o(c),s=n,n=r.currentSuggestionList[i.ord],s!=n&&e[s]!=undefined&&g(e[s],!0),f=i.panel,f&&(f.loaded?l(f,u):(a=i.getAttribute("hvurl"),a&&!et&&(c=v(function(){ui(f,n)},t.requestTimeout),ri(n,f,a))))}function ri(n,i,r){i.fetchTimer=v(function(){if(!i.fetching){i.fetching=!0;var f=ot.fetchUrl(r,n,i);u.raiseEvent(u.EventIds.DlRequestSent,i,n,f),i.timeoutTimer=v(function(){fi(i,n,f)},t.requestTimeout)}},20)}function ii(n,t,f,e){(e.fetching=!1,o(e.timeoutTimer),at)||(n!=null?(u.raiseEvent(u.EventIds.DlResponseReceived,e,f,t),e.loaded||(e.visible=!1,e.render(n),u.raiseEvent(u.EventIds.DlResponseRendered,e,f,t),i.drawerIsOpen()&&r.currentSuggestion&&r.currentSuggestion.query===f&&(e.loaded?l(e):k(e,f)))):k(e,f))}function ui(n,t){k(n,t),n.timeout=!0}function fi(n,t,i){u.raiseEvent(u.EventIds.DlRequestTimeout,n,t,i)}function k(t,i){t&&(t.renderError(),n===i&&l(t))}function it(i,f){var c=new Bing.AS.PreviewPaneManager.PreviewPane(i,ct),a,o,v,h;u.raiseEvent(u.EventIds.PaneCreated,c),e[f]=c,c.obd&&(n=r.currentSuggestionList[i.ord],c.render(),l(c,!0),t.asconfig.gst&&t.asconfig.gst!=1||(b!=w.KeyCodeBackspace&&b!=w.KeyCodeDelete&&i.hc?r.highlightSuggestion(i):r.highlightObdSuggestion(i)));n:for(a=0;o=i.childNodes[a++];)if(o.tagName=="DIV"&&o.className.indexOf("sa_s")!=-1&&o.childNodes.length>0)for(v=0;h=o.childNodes[v++];)if(h.tagName=="DIV"&&h.className.indexOf("sa_touch")!=-1){ti(h,"mousedown","mouseup","mouseover","mouseout","click"),sj_be(h,"click",function(){s.focus()},!0);break n}return i}function tt(n,t,i){if(o(n.fetchTimer),n.visible&&!n.closing){f=n,n.closing={h:null,cb:null};var r=function(){n.hide(t),n.closing&&n.closing.cb&&n.closing.cb(),y(n)};i>0?n.closing.h=v(r,i):r()}}function g(n,t){tt(n,t,ei)}function l(n,t){o(c),t?(f&&(f.hide(!0),y(f)),n.show()):f?n==f?y(f):f.closing.cb=function(){r.currentSuggestion==n.suggestion&&n.show()}:n.show()}function y(n){n.closing&&o(n.closing.h),delete n.closing,f=null}function ti(n){for(var t=1;t<arguments.length;t++)nt(n,arguments[t],sj_sp,!0)}function wt(u){var c,f,o;i=u,s=i.searchBox,h=i.autosuggest,r=h.canvas,nt(s,"keydown",function(n){b=n.keyCode}),c=t.asconfig=h.config,vt=s.style.width,t.showForFirst=c.eSP,t.requestTimeout=c.SCT,et=c.eECT,f=new Bing.AS.EventRegistration,f.add(Bing.AS.EventIds.ValidResponseReceived,ni),f.add(Bing.AS.EventIds.SuggestionsRendered,oi),f.add(Bing.AS.EventIds.MouseEnterSuggestion,a),f.add(Bing.AS.EventIds.NoItemSelected,function(){var t=e[n];t&&g(t,!0),n=""}),f.add(Bing.AS.EventIds.Disposed,dt),f.add(Bing.AS.EventIds.PreviewPaneEnabled,bt),f.add(Bing.AS.EventIds.PreviewPaneDisabled,yt),h.EventRegistry.push(f),o=new Bing.AS.EventRegistration,o.add(Bing.AS.EventIds.SelectNextItem,ut),o.add(Bing.AS.EventIds.SelectPrevItem,ut),o.add(Bing.AS.EventIds.DropDownHidden,pt),o.add(Bing.AS.EventIds.DropDownShown,kt),i.EventRegistry.push(o),rt(t,st),ot=new Bing.AS.DataProvider(c,w.PreviewPaneDataProvider,ii),ft=!0}function bt(){var t=e[n];t&&a(t.suggestion,!0),d(r.suggestionsContainer,lt)}function yt(){var t=e[n];t&&tt(t,!0,0),si(r.suggestionsContainer,lt)}function pt(){gt(),o(c),f&&y(f),n=""}function gt(){d(i.searchForm,p),t.asconfig.SBW&&(s.style.width=vt)}function kt(){t.asconfig.SBW&&(s.style.width=t.asconfig.SBW+"px",i.layout.update()),i.searchForm.className.indexOf(p)===-1&&(i.searchForm.className===""?i.searchForm.className=p:i.searchForm.className+=" "+p)}function rt(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])}function dt(){u.clear(),at=!0}var nt=sj_be,v=sb_st,o=sb_ct,ht=Bing.AS.Utils,d=ht.RemoveClassName,si=ht.AddClassName,w=Bing.AS.Constants,ct=/(\s|^)sa_se(\s|$)/g,p="sa_open",lt="sa_nchvrn",e={},h,r,i,n="",st={},ft,c,et=!1,ot,vt,s,ci=AutoSuggest.Service.SuggestionAttributes,at,b,t={asconfig:{},delayFix:50,maxNumOfEntities:5,requestTimeout:500,showForFirst:!1},f,ei=500,u=function(){var n=[];return{add:function(t){n.push(t)},clear:function(){n=[]},raiseEvent:function(t){for(var u=arguments.length?[].slice.apply(arguments).slice(1):[],i,r=0;i=n[r++];)i.events[t]&&i.events[t].apply(this,u)},EventIds:{PaneShown:1,PaneHidden:2,PaneCreated:3,PaneRendered:4,ErrorRendered:5,DlRequestSent:6,DlResponseReceived:7,DlRequestTimeout:8}}}();return{getSearchForm:function(){return i},changeConfig:function(n){var i=ft?t:st;rt(i,n)},getConfig:function(){return t},init:wt,extendSuggestion:it,Events:u}}(),Bing.AS.PreviewPaneManager.PreviewPane=function(){function v(t,i){this.manager=Bing.AS.PreviewPaneManager,n=this.manager.getSearchForm(),e=n.autosuggest.canvas,o=n.autosuggest.config;var f;(this.container=f=e.ge(t.getAttribute("hvid")),f)&&(n.autosuggest.cssVersioningEnabled&&(this.version=n.autosuggest.cssVersioningMgr.getVersion()),u=o.eECT,l=i,r=n.layout.getSuggestionsContainer(),t.panel=this,n.registerUIElement(f),b(f,"mousedown",function(n){n=sj_evas(n),p(sj_etas(n),f)||ut(n)},!0),b(f,"click",function(t){t=sj_evas(t),p(sj_etas(t),f)||n.searchBox.focus()},!0),this.actionItems=[],this.suggestion=t,f.className.indexOf("sa_eco")!=-1&&f.firstChild&&!u&&(this.obd=!0))}function p(n,t){while(n){if(n==t)break;if(n.isPPElem)return!0;n=n.parentNode}return!1}function y(n){for(var t=n.firstChild;t&&t.nodeType!=1;)t=t.nextSibling;return t}function tt(n){var i=y(n),t;if(i&&i.attributes)return t=i.attributes.ec,t?t.value=="0":!1}function nt(n,t){var u=y(t),f,i,o,s,r;if(u&&(f="getAttribute",i=u[f]("data"),n.eventId=u[f]("eventId"),i))for(i=i.split(";"),o=0;s=i[o++];)r=e.ge(s),r&&g(r,n)}function g(n,t){n.p_ord=t.actionItems.length,n.panel=t,n.isPPElem=!0,f.RewriteAttribsToProps(n,[a.Url,a.Query]),typeof n.url=="string"&&(n.addInst=n.url.indexOf("/search")==0),e.attachSuggestionEvents(n),n.className+=" sa_ac",t.actionItems.push(n)}var s=sj_ce,b=sj_be,ut=sj_sp,d=sb_st,h=sb_ct,i=Bing.AS.PreviewPaneManager.Events,f=Bing.AS.Utils,c=f.RemoveClassName,it=f.AddClassName,r,w,l,k="b_hide",ft=/(\s|^)sa_hv/g,rt=/(\s|^)sa_ppo/g,n,u=!1,e,o,a=AutoSuggest.Service.SuggestionAttributes,t=v.prototype;return t.loaded=!1,t.visible=!1,t.Builders={},t.actionItems=[],t.show=function(){if(h(w),h(this.ct),!this.visible){if(i.raiseEvent(i.EventIds.PaneShown,this),this.visible=!0,this.ot=sb_gt(),u)return;var t=this.container,f=r.parentNode;f.className.match(l)||(f.className+=" sa_se",this.suggestion.className+=" sa_ppo"),n.autosuggest.cssVersioningEnabled&&n.autosuggest.cssVersioningMgr.updateStylesInDom(this.version),c(t,k),t.offsetHeight>r.offsetHeight&&(r.style.height=t.offsetHeight+"px",o.ic&&n.layout.updateHeight())}},t.hide=function(t){var f=this,v=f.container,s,e,a;f.visible&&(s=sj_wf(c,r.parentNode,l),e=function(){(h(f.ct),i.raiseEvent(i.EventIds.PaneHidden,f),f.visible=!1,c(f.suggestion,rt),u)||(it(v,k),r.style.height="auto",o.ic&&n.layout.updateHeight())},t?(h(f.ct),e(),u||s()):(a=this.manager.getConfig().delayFix,f.ct=d(e,a),w=d(s,a)))},t.render=function(n){var t=this;n&&(t.container.innerHTML="",e.InsertAjaxResponseIntoDom(t.container,n)),t.timeout&&(t.timeout=!1),tt(t.container)&&(nt(t,t.container),t.loaded=!0,i.raiseEvent(i.EventIds.PaneRendered,t))},t.renderError=function(){var r;if(i.raiseEvent(i.EventIds.ErrorRendered,this),!u){this.container.innerHTML="";var e=s("div","","pp_1col"),n=s("div",this.container.id+"_0","pp_tile pp_1row"),t=s("div","","pp_err");n.setAttribute(a.Navigation,";;;"+this.suggestion.id),f.SetInnerText(t,sa_loc.PE+" "),r=s("span"),f.SetInnerText(r,this.suggestion.query),t.appendChild(r),n.appendChild(t),e.appendChild(n),n.query=this.suggestion.query,g(n,this),this.container.appendChild(e)}},v}(),sa_inst=new Bing.AS.SearchForm(sa_config),sa_inst.init("sa_inst"),sa_eL&&sa_inst.show(),_w.sj_evt&&sj_evt.fire("autoSugLoaded")